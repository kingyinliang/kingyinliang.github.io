(window.webpackJsonp=window.webpackJsonp||[]).push([[31],{269:function(s,a,t){"use strict";t.r(a);var n=t(0),e=Object(n.a)({},function(){var s=this,a=s.$createElement,t=s._self._c||a;return t("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[t("h2",{attrs:{id:"npm-包管理规范"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#npm-包管理规范","aria-hidden":"true"}},[s._v("#")]),s._v(" NPM 包管理规范")]),s._v(" "),t("p",[s._v("为了方便管理和维护组织内越来越多的 npm 公用包，以及良好的生态环境，特制定此规范")]),s._v(" "),t("h3",{attrs:{id:"package-json"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#package-json","aria-hidden":"true"}},[s._v("#")]),s._v(" package.json")]),s._v(" "),t("p",[t("code",[s._v("package.json")]),s._v(" 基础模板")]),s._v(" "),t("div",{staticClass:"language-js line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-js"}},[t("code",[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"name"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"my_package"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"description"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"awsome package"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"version"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"1.0.0"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"main"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"index.js"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"scripts"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"test"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"echo \\"Error: no test specified\\" && exit 1"')]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"repository"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"type"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"git"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"url"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"https://github.com/ashleygwilliams/my_package.git"')]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"keywords"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"author"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('""')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"license"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"ISC"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"bugs"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"url"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"https://github.com/ashleygwilliams/my_package/issues"')]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"homepage"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"https://github.com/ashleygwilliams/my_package"')]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br"),t("span",{staticClass:"line-number"},[s._v("13")]),t("br"),t("span",{staticClass:"line-number"},[s._v("14")]),t("br"),t("span",{staticClass:"line-number"},[s._v("15")]),t("br"),t("span",{staticClass:"line-number"},[s._v("16")]),t("br"),t("span",{staticClass:"line-number"},[s._v("17")]),t("br"),t("span",{staticClass:"line-number"},[s._v("18")]),t("br"),t("span",{staticClass:"line-number"},[s._v("19")]),t("br"),t("span",{staticClass:"line-number"},[s._v("20")]),t("br")])]),t("h4",{attrs:{id:"name"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#name","aria-hidden":"true"}},[s._v("#")]),s._v(" name")]),s._v(" "),t("p",[s._v("必须使用小写，多词之间使用 连字符 - 间隔"),t("br"),s._v("\n并且必须满足以下条件")]),s._v(" "),t("ul",[t("li",[s._v("唯一的")]),s._v(" "),t("li",[s._v("描述性质的")]),s._v(" "),t("li",[s._v("非攻击性词汇")]),s._v(" "),t("li",[s._v("非商标类词汇")]),s._v(" "),t("li",[s._v("非别人拥有的名字")]),s._v(" "),t("li",[s._v("非已有包名的简写")]),s._v(" "),t("li",[s._v("非已有包名的类似名字混搅")])]),s._v(" "),t("p",[s._v("示例："),t("code",[s._v("uploader")]),s._v(", "),t("code",[s._v("milk-finder")]),s._v(", "),t("code",[s._v("one-to-three")])]),s._v(" "),t("h4",{attrs:{id:"description"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#description","aria-hidden":"true"}},[s._v("#")]),s._v(" description")]),s._v(" "),t("p",[s._v("包的简单描述")]),s._v(" "),t("h4",{attrs:{id:"version"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#version","aria-hidden":"true"}},[s._v("#")]),s._v(" version")]),s._v(" "),t("p",[s._v("包版本号，默认为 1.0.0")]),s._v(" "),t("ul",[t("li",[s._v("1.0.1 通常为 bug fix")]),s._v(" "),t("li",[s._v("1.1.0 新的功能，但向后兼容")]),s._v(" "),t("li",[s._v("2.0.0 新的功能，不再向后兼容")])]),s._v(" "),t("h4",{attrs:{id:"main"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#main","aria-hidden":"true"}},[s._v("#")]),s._v(" main")]),s._v(" "),t("p",[s._v("默认入口，默认为根目录 "),t("code",[s._v("index.js")])]),s._v(" "),t("blockquote",[t("p",[s._v("全局包需要在 index.js 的第一行添加 #!/usr/bin/env node 否则 windows 系统中可能不会以 nodejs 去执行入口")])]),s._v(" "),t("h4",{attrs:{id:"scripts"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#scripts","aria-hidden":"true"}},[s._v("#")]),s._v(" scripts")]),s._v(" "),t("p",[s._v("快捷的脚本地址")]),s._v(" "),t("div",{staticClass:"language-js line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-js"}},[t("code",[s._v("npm run test\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("h4",{attrs:{id:"repository"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#repository","aria-hidden":"true"}},[s._v("#")]),s._v(" repository")]),s._v(" "),t("p",[s._v("包的仓库地址")]),s._v(" "),t("h4",{attrs:{id:"keywords"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#keywords","aria-hidden":"true"}},[s._v("#")]),s._v(" keywords")]),s._v(" "),t("p",[s._v("包的关键字，其他开发者在 "),t("code",[s._v("npmjs.org")]),s._v(" 查看你的包时以标签形式展示")]),s._v(" "),t("h4",{attrs:{id:"author"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#author","aria-hidden":"true"}},[s._v("#")]),s._v(" author")]),s._v(" "),t("p",[s._v("包作者"),t("br"),s._v("\n示例： Your Name email@example.com (http://example.com)")]),s._v(" "),t("h4",{attrs:{id:"license"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#license","aria-hidden":"true"}},[s._v("#")]),s._v(" license")]),s._v(" "),t("p",[s._v("代码许可标识，默认 "),t("code",[s._v("ISC")])]),s._v(" "),t("h4",{attrs:{id:"bugs"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#bugs","aria-hidden":"true"}},[s._v("#")]),s._v(" bugs")]),s._v(" "),t("p",[s._v("使用过程中遇到 bug 时，提交或者解决问题的地址")]),s._v(" "),t("h4",{attrs:{id:"bin"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#bin","aria-hidden":"true"}},[s._v("#")]),s._v(" bin")]),s._v(" "),t("p",[s._v("配置全局安装包执行的命令，及执行文件地址")]),s._v(" "),t("div",{staticClass:"language-js line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-js"}},[t("code",[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"xxx"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"index.js"')]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br")])]),t("p",[s._v("全局安装后，可以在命令行 xxx 执行到对应文件")]),s._v(" "),t("h4",{attrs:{id:"dependencies"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#dependencies","aria-hidden":"true"}},[s._v("#")]),s._v(" dependencies")]),s._v(" "),t("p",[s._v("生产环境需要的依赖包")]),s._v(" "),t("blockquote",[t("p",[s._v("提示：仅限配置生产环境需要的依赖, 开发&测试环境需要的依赖包配置到 "),t("code",[s._v("devDependencies")])])]),s._v(" "),t("h4",{attrs:{id:"devdependencies"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#devdependencies","aria-hidden":"true"}},[s._v("#")]),s._v(" devDependencies")]),s._v(" "),t("p",[s._v("测试环境用到的依赖包")]),s._v(" "),t("h3",{attrs:{id:"modules"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#modules","aria-hidden":"true"}},[s._v("#")]),s._v(" modules")]),s._v(" "),t("p",[s._v("应考虑兼容到 "),t("code",[s._v("CommonJS")]),s._v(" "),t("code",[s._v("AMD")]),s._v(" "),t("code",[s._v("CMD")]),s._v(" 以及 "),t("code",[s._v("浏览器")]),s._v(" 直接引入使用")]),s._v(" "),t("h3",{attrs:{id:"测试"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#测试","aria-hidden":"true"}},[s._v("#")]),s._v(" 测试")]),s._v(" "),t("p",[s._v("必须包含所有功能的测试在 "),t("code",[s._v("test")]),s._v(" 文件夹中")]),s._v(" "),t("h3",{attrs:{id:"demo"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#demo","aria-hidden":"true"}},[s._v("#")]),s._v(" DEMO")]),s._v(" "),t("h3",{attrs:{id:"readme-md"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#readme-md","aria-hidden":"true"}},[s._v("#")]),s._v(" README.md")]),s._v(" "),t("p",[s._v("为了帮助其他开发人员, 使用你的包时有更好的体验, 推荐在根目录添加 "),t("code",[s._v("readme.md")]),s._v(" 描述如何安装、配置和使用你的包")]),s._v(" "),t("h3",{attrs:{id:"发布"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#发布","aria-hidden":"true"}},[s._v("#")]),s._v(" 发布")]),s._v(" "),t("p",[s._v("发布时需设置 "),t("code",[s._v("域")]),s._v(" 名称\n个人发布使用自己姓名全拼做域名"),t("code",[s._v("@<name>")])]),s._v(" "),t("div",{staticClass:"language-text line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[s._v("# 设置包域名为姓名全拼\nnpm init --scope=@zhangkangxin\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br")])]),t("p",[s._v("项目组发布以项目组名 "),t("code",[s._v("@<project-name>")]),s._v(" 作为域名")]),s._v(" "),t("div",{staticClass:"language-text line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[s._v("# 设置包域名为项目名称 @arch\nnpm init --scope=@arch\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br")])]),t("p",[s._v("非项目组的包名应以部门 "),t("code",[s._v("@<depart-name>")]),s._v(" 作为域名")]),s._v(" "),t("div",{staticClass:"language-text line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[s._v("# 设置包域名为部门 @financial\nnpm init --scope=@financial\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br")])]),t("p",[s._v("执行发布")]),s._v(" "),t("div",{staticClass:"language-text line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[s._v("npm publish --access public\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("div",{staticClass:"warning custom-block"},[t("p",[s._v("开发人员应避免包中含敏感信息。例: npm 账号密码、私有 keys 、私人资料、信用卡信息")])]),s._v(" "),t("h3",{attrs:{id:"依赖包更新与检测"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#依赖包更新与检测","aria-hidden":"true"}},[s._v("#")]),s._v(" 依赖包更新与检测")]),s._v(" "),t("p",[s._v("定期使用 "),t("code",[s._v("npm audit")]),s._v(" 命令检测 "),t("code",[s._v("package.json")]),s._v(" 依赖包是否有漏洞")]),s._v(" "),t("h2",{attrs:{id:"npm-私服搭建"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#npm-私服搭建","aria-hidden":"true"}},[s._v("#")]),s._v(" npm 私服搭建")]),s._v(" "),t("h3",{attrs:{id:"verdaccio"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#verdaccio","aria-hidden":"true"}},[s._v("#")]),s._v(" Verdaccio")]),s._v(" "),t("blockquote",[t("p",[s._v("Verdaccio是一个简单的，零配置所需的本地私有npm注册表。不需要整个数据库就可以开始使用！Verdaccio开箱即用，拥有自己的小型数据库，能够代理其他注册表（例如npmjs.org），一路缓存下载的模块。")])]),s._v(" "),t("h3",{attrs:{id:"搭建过程"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#搭建过程","aria-hidden":"true"}},[s._v("#")]),s._v(" 搭建过程")]),s._v(" "),t("h4",{attrs:{id:"安装verdaccio"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#安装verdaccio","aria-hidden":"true"}},[s._v("#")]),s._v(" 安装verdaccio")]),s._v(" "),t("div",{staticClass:"language-text line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[s._v("$ npm install --global verdaccio\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("h4",{attrs:{id:"配置文件"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#配置文件","aria-hidden":"true"}},[s._v("#")]),s._v(" 配置文件")]),s._v(" "),t("p",[s._v("verdaccio 的特点是，你在哪个目录运行，它的就会在对应的目录下创建自己的文件。目录下默认有两个文件：config.yaml和storage，htpasswd 是添加用户之后自动创建的；\n由于第一次启动默认的config.xml文件是从原始文件default.yaml拷贝而来，可先修改verdaccio 原始的default.yaml。\n地址：verdaccio 安装目录/conf/ default.yaml。"),t("br"),s._v("\n打开默认启动的config.yaml文件。")]),s._v(" "),t("div",{staticClass:"language-js line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-js"}},[t("code",[s._v("#设置"),t("span",{pre:!0,attrs:{class:"token constant"}},[s._v("NPM")]),s._v("包的存放目录\nstorage"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("storage\n#配置"),t("span",{pre:!0,attrs:{class:"token constant"}},[s._v("WEB")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token constant"}},[s._v("UI")]),s._v("界面\nweb "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n  title "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" ‘搭建私有"),t("span",{pre:!0,attrs:{class:"token constant"}},[s._v("NPM")]),s._v("’\n  #logo "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" logo"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("png\n#设置用户验证的文件。\nauth"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n  htpasswd"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n  file"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("htpasswd\n  max_users"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1000")]),s._v("   #默认为"),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1000")]),s._v("，改为"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("，禁止注册\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("#设置其它的npm注册源")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("registry"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\nuplinks"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n  npmjs"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n  url"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" https"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),t("span",{pre:!0,attrs:{class:"token regex"}},[s._v("/registry.npmjs.org/")]),s._v(" \n#配置权限管理\npackages"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n   ‘@"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("’"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n  #表示哪一类用户可以对匹配的项目进行安装 【$all 表示所有人都可以执行对应的操作，$authenticated 表示只有通过验证的人可以执行对应操作，$anonymous 表示只有匿名者可以进行对应操作（通常无用）】\n  access"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" $all\n  #表示哪一类用户可以对匹配的项目进行发布\n  publish"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" $authenticated\n‘"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),s._v("’"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n  #表示哪一类用户可以对匹配的项目进行安装\n  access"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" $all\n  #表示哪一类用户可以对匹配的项目进行发布\n  publish"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" $authenticated\n  # 如果一个npm包不存在，它会去询问设置的代理。\n  proxy"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" npmjs\n#日志输出设置\nlogs"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n   "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("type"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" stdout"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" format"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" pretty"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" level"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" http"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n  #"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("type"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" file"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" path"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" verdaccio"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("log"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" level"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" info"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n#修改监听的端口\nlisten"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.0")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v(".0")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v(".0")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("4873")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br"),t("span",{staticClass:"line-number"},[s._v("13")]),t("br"),t("span",{staticClass:"line-number"},[s._v("14")]),t("br"),t("span",{staticClass:"line-number"},[s._v("15")]),t("br"),t("span",{staticClass:"line-number"},[s._v("16")]),t("br"),t("span",{staticClass:"line-number"},[s._v("17")]),t("br"),t("span",{staticClass:"line-number"},[s._v("18")]),t("br"),t("span",{staticClass:"line-number"},[s._v("19")]),t("br"),t("span",{staticClass:"line-number"},[s._v("20")]),t("br"),t("span",{staticClass:"line-number"},[s._v("21")]),t("br"),t("span",{staticClass:"line-number"},[s._v("22")]),t("br"),t("span",{staticClass:"line-number"},[s._v("23")]),t("br"),t("span",{staticClass:"line-number"},[s._v("24")]),t("br"),t("span",{staticClass:"line-number"},[s._v("25")]),t("br"),t("span",{staticClass:"line-number"},[s._v("26")]),t("br"),t("span",{staticClass:"line-number"},[s._v("27")]),t("br"),t("span",{staticClass:"line-number"},[s._v("28")]),t("br"),t("span",{staticClass:"line-number"},[s._v("29")]),t("br"),t("span",{staticClass:"line-number"},[s._v("30")]),t("br"),t("span",{staticClass:"line-number"},[s._v("31")]),t("br"),t("span",{staticClass:"line-number"},[s._v("32")]),t("br"),t("span",{staticClass:"line-number"},[s._v("33")]),t("br"),t("span",{staticClass:"line-number"},[s._v("34")]),t("br"),t("span",{staticClass:"line-number"},[s._v("35")]),t("br")])]),t("div",{staticClass:"language-text line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[s._v("firewall-cmd --state                # 先查看防火墙状态，\nservice firewalld start              # 开启防火墙:\nfirewall-cmd --zone=public --add-port=4873/tcp –permanent  #开放4873端口\nfirewall-cmd --reload              #重新载入\nfirewall-cmd --zone=public --query-port=4873/tcp    #查看是否添加成功\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br")])]),t("p",[s._v("修改完了配置，到verdaccio目录下通过$ verdaccio -c config.yaml更新一下")]),s._v(" "),t("h3",{attrs:{id:"启动"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#启动","aria-hidden":"true"}},[s._v("#")]),s._v(" 启动")]),s._v(" "),t("div",{staticClass:"language-text line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[s._v("$ verdaccio\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("h4",{attrs:{id:"pm2守护verdaccio进程"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#pm2守护verdaccio进程","aria-hidden":"true"}},[s._v("#")]),s._v(" pm2守护verdaccio进程")]),s._v(" "),t("p",[s._v("利用第一种方法虽然可以正常启动和使用verdaccio，但不建议用这种方式启动verdaccio，我们可以用pm2来使用pm2对verdaccio进程进行托管启动。"),t("br"),s._v("\n安装pm2并使用pm2启动verdaccio，使用pm2托管的进程可以保证进程永远是活着的，尝试通过kill -9去杀verdaccio的进程发现杀了之后又自动启起来。推荐使用此种方式启动verdaccio.\n安装pm2")]),s._v(" "),t("div",{staticClass:"language-text line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[s._v("npm install -g pm2 --unsafe-perm\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("p",[s._v("使用pm2启动verdaccio")]),s._v(" "),t("div",{staticClass:"language-text line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[s._v("pm2 start verdaccio\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("p",[s._v("查看pm2 守护下的进程verdaccio的实时日志")]),s._v(" "),t("div",{staticClass:"language-text line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[s._v("pm2 show verdaccio  \n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("p",[s._v("通过这个命令我们可以从下图中看到所有verdaccio的所有信息，打开 out log path查看进程输出日志,出现错误时候也可以打开error log来查看错误日志。")]),s._v(" "),t("h3",{attrs:{id:"创建用户"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#创建用户","aria-hidden":"true"}},[s._v("#")]),s._v(" 创建用户")]),s._v(" "),t("div",{staticClass:"language-text line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[s._v("npm adduser --registry /* ip */\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("p",[s._v("然后我们在ip地址上面直接点Login就可以登陆了\n这里，如果我们已经装了nrm ，可以简便上面这句操作：我们直接利用nrm把镜像源切换到我们的"),t("code",[s._v("ip/npm")]),s._v("上面，然后$ "),t("code",[s._v("npm adduser")]),s._v("就可以了")]),s._v(" "),t("h3",{attrs:{id:"与私服连接"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#与私服连接","aria-hidden":"true"}},[s._v("#")]),s._v(" 与私服连接")]),s._v(" "),t("div",{staticClass:"language-text line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[s._v("npm set registry http://192.168.XX.50：4873 \n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("h3",{attrs:{id:"安装nrm"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#安装nrm","aria-hidden":"true"}},[s._v("#")]),s._v(" 安装nrm")]),s._v(" "),t("p",[s._v("nrm是 npm registry 管理工具, 能够查看和切换当前使用的registry。不安装也可以，安装会更高效")]),s._v(" "),t("div",{staticClass:"language-text line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[s._v("npm install -g nrm\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("p",[s._v("添加私服地址到nrm管理工具")]),s._v(" "),t("div",{staticClass:"language-text line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[s._v("nrm add kingyinliang http://192.168.XX.50:4873    #添加本地私服地址\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("p",[s._v("这里的kingyinliang是我们给自己的私服地址起的别名，为了切换和使用方便。"),t("br"),s._v("\n将npm包的下载地址改到kingyinliang的私服。")]),s._v(" "),t("div",{staticClass:"language-text line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[s._v("nrm use kingyinliang verb config Skipping project config: C:\\Users\\kingyinliang/.npmrc. (matches userconfig)\nRegistry has been set to: http://192.168.XX.50:4873/\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br")])]),t("p",[s._v("使用nrm ls可查到我们可以使用的所有镜像源地址，* 后面是当前使用的，如果我们不想从私服上下载包，就可以用上一步骤的nrm use命令，use其它的地址，将下载地址改到别的服务器。")]),s._v(" "),t("div",{staticClass:"language-text line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[s._v("C:\\Users\\Hepburn Yang>nrm ls\n\n  npm ---- https://registry.npmjs.org/\n  cnpm --- http://r.cnpmjs.org/\n  taobao - https://registry.npm.taobao.org/\n  nj ----- https://registry.nodejitsu.com/\n  rednpm - http://registry.mirror.cqupt.edu.cn/\n  npmMirror  https://skimdb.npmjs.com/registry/\n  edunpm - http://registry.enpmjs.org/ \n* kingyinliang --- http://192.168.XX.50:4873/\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br")])]),t("h3",{attrs:{id:"发布包"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#发布包","aria-hidden":"true"}},[s._v("#")]),s._v(" 发布包")]),s._v(" "),t("div",{staticClass:"language-text line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[s._v("npm publish           #已经切换到我们私服地址的情况下\nnpm publish --registry http://192.168.XX.50:4873   #未切换到我们的私服时，直接加后缀可以发布到私服上。\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br")])]),t("h3",{attrs:{id:"同步项目所需要的包到verdaccio中"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#同步项目所需要的包到verdaccio中","aria-hidden":"true"}},[s._v("#")]),s._v(" 同步项目所需要的包到verdaccio中")]),s._v(" "),t("p",[t("a",{attrs:{"data-fancybox":"",title:"npm",href:"/standard/workflow/work19.jpg"}},[t("img",{attrs:{src:"/standard/workflow/work19.jpg",alt:"npm.jpg",title:"npm"}})])])])},[],!1,null,null,null);a.default=e.exports}}]);